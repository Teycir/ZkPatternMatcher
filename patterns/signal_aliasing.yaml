patterns:
  # Pattern: Component port assignment (info-level anchor)
  # Used to flag lines for manual cross-reference
  - id: component_port_assignment
    kind: regex
    pattern: '^\s*\w+\.\w+\s*<==\s*(\w+)\s*;'
    message: >
      INFO: Component port assignment detected. Manually verify that the same
      signal is not wired to multiple independent component inputs within this
      template. Signal aliasing collapses proof degrees of freedom.
    severity: info

  # Pattern: Intermediate array unconstrained assignment
  - id: intermediate_array_unconstrained
    kind: regex
    pattern: '\bintermediate\s*\[\s*\d+\s*\]\s*<--'
    message: >
      MEDIUM: Intermediate array element assigned with <-- (unconstrained).
      In Merkle path circuits, each intermediate[i] must be constrained to
      prevent path forgery. Ensure a corresponding constraint equation exists:
        intermediate[i] === left_child * selector + right_child * (1 - selector);
    severity: medium

invariants:
  - name: no_signal_aliasing
    invariant_type: constraint
    relation: "distinct_signals_for_independent_inputs"
    oracle: must_hold
    severity: high
    description: "Component inputs designed for independent witnesses must not be aliased"
